<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-02-21T20:28:09-07:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Advanced Counting Using PIE</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><link href="https://webwork-ptx.aimath.org/webwork2_files/js/apps/MathView/mathview.css" rel="stylesheet">
<script src="https://webwork-ptx.aimath.org/webwork2_files/js/vendor/iframe-resizer/js/iframeResizer.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="custom-styles.css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link href="developer.css" rel="stylesheet" type="text/css">
</head>
<body id="levin-DMEGT" class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\renewcommand{\d}{\displaystyle}
\newcommand{\N}{\mathbb N}
\newcommand{\B}{\mathbf B}
\newcommand{\Z}{\mathbb Z}
\newcommand{\Q}{\mathbb Q}
\newcommand{\R}{\mathbb R}
\newcommand{\C}{\mathbb C}
\newcommand{\U}{\mathcal U}
\newcommand{\pow}{\mathcal P}
\newcommand{\inv}{^{-1}}
\newcommand{\st}{:}
\renewcommand{\iff}{\leftrightarrow}
\newcommand{\Iff}{\Leftrightarrow}
\newcommand{\imp}{\rightarrow}
\newcommand{\Imp}{\Rightarrow}
\newcommand{\isom}{\cong}

\renewcommand{\bar}{\overline}
\newcommand{\card}[1]{\left| #1 \right|}
\newcommand{\twoline}[2]{\begin{pmatrix}#1 \\ #2 \end{pmatrix}}

\newcommand{\vtx}[2]{node[fill,circle,inner sep=0pt, minimum size=4pt,label=#1:#2]{}}
\newcommand{\va}[1]{\vtx{above}{#1}}
\newcommand{\vb}[1]{\vtx{below}{#1}}
\newcommand{\vr}[1]{\vtx{right}{#1}}
\newcommand{\vl}[1]{\vtx{left}{#1}}
\renewcommand{\v}{\vtx{above}{}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href="http://discrete.openmathbooks.org/dmoi3.html" target="_blank"><img src="images/cover.png" alt="Logo image"></a><div class="title-container">
<h1 class="heading"><a href="dmegt.html"><span class="title">Discrete Mathematics:</span> <span class="subtitle">Early Graph Theory</span></a></h1>
<p class="byline">Oscar Levin</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="index-button toolbar-item button" href="index-1.html" title="Index">Index</a><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="sec_stars-and-bars.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="ch_counting.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="sec_count-conc.html" title="Next">Next</a></span>
</div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="sec_stars-and-bars.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="ch_counting.html" title="Up">Up</a><a class="next-button button toolbar-item" href="sec_count-conc.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link">
<a href="frontmatter.html" data-scroll="RGW"><span class="title">Front Matter</span></a><ul>
<li><a href="colophon-1.html" data-scroll="colophon-1">Colophon</a></li>
<li><a href="dedication-1.html" data-scroll="dedication-1">Dedication</a></li>
<li><a href="acknowledgement-1.html" data-scroll="acknowledgement-1">Acknowledgements</a></li>
<li><a href="preface.html" data-scroll="xOf">Preface</a></li>
<li><a href="preface-2.html" data-scroll="dVo">How to use this book</a></li>
</ul>
</li>
<li class="link">
<a href="ch_graphtheory.html" data-scroll="gBz"><span class="codenumber">1</span> <span class="title">Graphs and other Discrete Structures</span></a><ul>
<li><a href="sec_intro-intro.html" data-scroll="hPw">What is Discrete Mathematics?</a></li>
<li><a href="sec_gt-intro.html" data-scroll="HLu">Graphs</a></li>
<li><a href="sec_intro-sets.html" data-scroll="ltW">Sets</a></li>
<li><a href="sec_intro-functions.html" data-scroll="CkQ">Functions</a></li>
<li><a href="sec_gt-carefully.html" data-scroll="sec_gt-carefully">Graphs Done Right</a></li>
<li><a href="sec_coloring.html" data-scroll="qyO">Coloring</a></li>
</ul>
</li>
<li class="link">
<a href="ch_logic.html" data-scroll="wur"><span class="codenumber">2</span> <span class="title">Symbolic Logic and Proofs</span></a><ul>
<li><a href="sec_intro-statements.html" data-scroll="QDd">Mathematical Statements</a></li>
<li><a href="sec_propositional.html" data-scroll="XMq">Propositional Logic</a></li>
<li><a href="sec_logic-proofs.html" data-scroll="lnf">Proofs</a></li>
<li><a href="sec_logic-induction.html" data-scroll="lnf">Mathematical Induction</a></li>
<li><a href="sec_trees.html" data-scroll="gor">Trees</a></li>
<li><a href="sec_paths.html" data-scroll="tPg">Euler Paths and Circuits</a></li>
<li><a href="sec_planar.html" data-scroll="ttH">Planar Graphs</a></li>
</ul>
</li>
<li class="link">
<a href="ch_counting.html" data-scroll="raE"><span class="codenumber">3</span> <span class="title">Counting</span></a><ul>
<li><a href="sec_counting-pascal.html" data-scroll="sJa">Pascal's Triangle</a></li>
<li><a href="sec_counting-addmult.html" data-scroll="sJa">Additive and Multiplicative Principles</a></li>
<li><a href="sec_counting-binom.html" data-scroll="vZs">Binomial Coefficients</a></li>
<li><a href="sec_counting-combperm.html" data-scroll="yda">Combinations and Permutations</a></li>
<li><a href="sec_comb-proofs.html" data-scroll="SUg">Combinatorial Proofs</a></li>
<li><a href="sec_stars-and-bars.html" data-scroll="qkt">Stars and Bars</a></li>
<li><a href="sec_advPIE.html" data-scroll="HKU" class="active">Advanced Counting Using PIE</a></li>
<li><a href="sec_count-conc.html" data-scroll="Bmb">Chapter Summary</a></li>
</ul>
</li>
<li class="link">
<a href="ch_sequences.html" data-scroll="KxW"><span class="codenumber">4</span> <span class="title">Sequences</span></a><ul>
<li><a href="sec_seq_intro.html" data-scroll="tgm">Describing Sequences</a></li>
<li><a href="sec_seq-arithgeom.html" data-scroll="lIR">Arithmetic and Geometric Sequences</a></li>
<li><a href="sec_polyfit.html" data-scroll="ylR">Polynomial Fitting</a></li>
<li><a href="sec_recurrence.html" data-scroll="bcV">Solving Recurrence Relations</a></li>
<li><a href="sec_addtops-genfun.html" data-scroll="XaJ">Generating Functions</a></li>
<li><a href="sec_sequences-conc.html" data-scroll="YaY">Chapter Summary</a></li>
</ul>
</li>
<li class="link"><a href="backmatter.html" data-scroll="mqL"><span class="title">Backmatter</span></a></li>
<li class="link"><a href="solutions-1.html" data-scroll="SxU"><span class="codenumber">A</span> <span class="title">Selected Hints</span></a></li>
<li class="link"><a href="solutions-2.html" data-scroll="yFd"><span class="codenumber">B</span> <span class="title">Selected Solutions</span></a></li>
<li class="link"><a href="appendix-1.html" data-scroll="GjC"><span class="codenumber">C</span> <span class="title">List of Symbols</span></a></li>
<li class="link"><a href="index-1.html" data-scroll="index-1"><span class="title">Index</span></a></li>
<li class="link"><a href="colophon-2.html" data-scroll="colophon-2"><span class="title">Colophon</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="HKU"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">3.7</span> <span class="title">Advanced Counting Using PIE</span>
</h2>
<a href="sec_advPIE.html" class="permalink">¶</a><section class="introduction" id="BVI"><article class="project-like" id="icR"><h6 class="heading">
<span class="type">Investigate!</span> </h6>
<p id="lVM">You have 11 identical mini key-lime pies to give to 4 children. However, you don't want any kid to get more than 3 pies. How many ways can you distribute the pies?</p>
<ol class="decimal">
<li id="Wyt"><p id="cXz">How many ways are there to distribute the pies without any restriction?</p></li>
<li id="CFC"><p id="JeI">Let's get rid of the ways that one or more kid gets too many pies. How many ways are there to distribute the pies if Al gets too many pies? What if Bruce gets too many? Or Cat? Or Dent?</p></li>
<li id="iML"><p id="plR">What if two kids get too many pies? How many ways can this happen? Does it matter which two kids you pick to overfeed?</p></li>
<li id="OTU"><p id="Vta">Is it possible that three kids get too many pies? If so, how many ways can this happen?</p></li>
<li id="vbd"><p id="BAj">How should you combine all the numbers you found above to answer the original question?</p></li>
</ol>
<p id="ScV">Suppose now you have 13 pies and 7 children. No child can have more than 2 pies. How many ways can you distribute the pies?</p></article><p id="yke">Stars and bars allows us to count the number of ways to distribute 10 cookies to 3 kids and natural number solutions to \(x+y+z = 11\text{,}\) for example. A relatively easy modification allows us to put a <em class="emphasis">lower bound</em> restriction on these problems: perhaps each kid must get at least two cookies or \(x,y,z \ge 2\text{.}\) This was done by first assigning each kid (or variable) 2 cookies (or units) and then distributing the rest using stars and bars.</p>
<p id="ern"> What if we wanted an <em class="emphasis">upper bound</em> restriction? For example, we might insist that no kid gets more than 4 cookies or that \(x,
y, z \le 4\text{.}\) It turns out this is considerably harder, but still possible. The idea is to count all the distributions and then remove those that violate the condition. In other words, we must count the number of ways to distribute 11 cookies to 3 kids in which <em class="emphasis">one or more</em> of the kids gets more than 4 cookies. For any particular kid, this is not a problem; we do this using stars and bars. But how to combine the number of ways for kid A, or B or C? We must use the PIE.</p>
<p id="Kyw">The Principle of Inclusion/Exclusion (PIE) gives a method for finding the cardinality of the union of not necessarily disjoint sets. We saw in <a href="sec_counting-addmult.html" class="internal" title="Section 3.2: Additive and Multiplicative Principles">Section 3.2</a> how this works with three sets. To find how many things are in <em class="emphasis">one or more</em> of the sets \(A\text{,}\) \(B\text{,}\) and \(C\text{,}\) we should just add up the number of things in each of these sets. However, if there is any overlap among the sets, those elements are counted multiple times. So we subtract the things in each intersection of a pair of sets. But doing this removes elements which are in all three sets once too often, so we need to add it back in. In terms of cardinality of sets, we have</p>
<div class="displaymath">
\begin{equation*}
|A \cup B \cup C| = |A| + |B| + |C| - |A \cap B| - |A \cap C| - |B \cap C| + |A\cap B \cap C|\text{.}
\end{equation*}
</div>
<article class="example example-like" id="JAh"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.1</span><span class="period">.</span>
</h6>
<p id="QnI">Three kids, Alberto, Bernadette, and Carlos, decide to share 11 cookies. They wonder how many ways they could split the cookies up provided that none of them receive more than 4 cookies (someone receiving no cookies is for some reason acceptable to these kids).</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-Oka" id="Oka"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-Oka"><div class="solution solution-like">
<p id="UnH">Without the “no more than 4” restriction, the answer would be \({13 \choose 2}\text{,}\) using 11 stars and 2 bars (separating the three kids). Now count the number of ways that one or more of the kids violates the condition, i.e., gets at least 4 cookies.</p>
<p id="AuQ">Let \(A\) be the set of outcomes in which Alberto gets more than 4 cookies. Let \(B\) be the set of outcomes in which Bernadette gets more than 4 cookies. Let \(C\) be the set of outcomes in which Carlos gets more than 4 cookies. We then are looking (for the sake of subtraction) for the size of the set \(A \cup B \cup C\text{.}\) Using PIE, we must find the sizes of \(|A|\text{,}\) \(|B|\text{,}\) \(|C|\text{,}\) \(|A\cap B|\) and so on. Here is what we find.</p>
<ul id="gBZ" class="disc">
<li id="AQp">\(|A| = {8 \choose 2}\text{.}\) First give Alberto 5 cookies, then distribute the remaining 6 to the three kids without restrictions, using 6 stars and 2 bars.</li>
<li id="gXy">\(|B| = {8 \choose 2}\text{.}\) Just like above, only now Bernadette gets 5 cookies at the start.</li>
<li id="NeH">\(|C| = {8 \choose 2}\text{.}\) Carlos gets 5 cookies first.</li>
<li id="tlQ">\(|A \cap B| = {3 \choose 2}\text{.}\) Give Alberto and Bernadette 5 cookies each, leaving 1 (star) to distribute to the three kids (2 bars).</li>
<li id="ZsZ">\(|A \cap C| = {3 \choose 2}\text{.}\) Alberto and Carlos get 5 cookies first.</li>
<li id="FAi">\(|B \cap C| = {3 \choose 2}\text{.}\) Bernadette and Carlos get 5 cookies first.</li>
<li id="lHr">\(|A \cap B \cap C| = 0\text{.}\) It is not possible for all three kids to get 4 or more cookies.</li>
</ul>
<p id="MJi">Combining all of these we see</p>
<div class="displaymath">
\begin{equation*}
|A \cup B \cup C| = {8 \choose 2} + {8 \choose 2} + {8 \choose 2} - {3 \choose 2} - {3 \choose 2} - {3 \choose 2} + 0 = 75\text{.}
\end{equation*}
</div>
<p id="sQr">Thus the answer to the original question is \({13 \choose 2} - 75 = 78 - 75 = 3\text{.}\) This makes sense now that we see it. The only way to ensure that no kid gets more than 4 cookies is to give two kids 4 cookies and one kid 3; there are three choices for which kid that should be. We could have found the answer much quicker through this observation, but the point of the example is to illustrate that PIE works!</p>
</div></div>
</div></article><p id="qFF"> For four or more sets, we do not write down a formula for PIE. Instead, we just think of the principle: add up all the elements in single sets, then subtract out things you counted twice (elements in the intersection of a <em class="emphasis">pair</em> of sets), then add back in elements you removed too often (elements in the intersection of groups of three sets), then take back out elements you added back in too often (elements in the intersection of groups of four sets), then add back in, take back out, add back in, etc. This would be very difficult if it wasn't for the fact that in these problems, all the cardinalities of the single sets are equal, as are all the cardinalities of the intersections of two sets, and that of three sets, and so on. Thus we can group all of these together and multiply by how many different combinations of 1, 2, 3, … sets there are.</p>
<article class="example example-like" id="pHq"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.2</span><span class="period">.</span>
</h6>
<p id="wuR">How many ways can you distribute 10 cookies to 4 kids so that no kid gets more than 2 cookies?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-urj" id="urj"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-urj"><div class="solution solution-like">
<p id="YXA">There are \({13 \choose 3}\) ways to distribute 10 cookies to 4 kids (using 10 stars and 3 bars). We will subtract all the outcomes in which a kid gets 3 or more cookies. How many outcomes are there like that? We can force kid A to eat 3 or more cookies by giving him 3 cookies before we start. Doing so reduces the problem to one in which we have 7 cookies to give to 4 kids without any restrictions. In that case, we have 7 stars (the 7 remaining cookies) and 3 bars (one less than the number of kids) so we can distribute the cookies in \({10 \choose 3}\) ways. Of course we could choose any one of the 4 kids to give too many cookies, so it would appear that there are \({4 \choose 1}{10 \choose 3}\) ways to distribute the cookies giving too many to one kid. But in fact, we have over counted.</p>
<p id="FeJ">We must get rid of the outcomes in which two kids have too many cookies. There are \({4 \choose 2}\) ways to select 2 kids to give extra cookies. It takes 6 cookies to do this, leaving only 4 cookies. So we have 4 stars and still 3 bars. The remaining 4 cookies can thus be distributed in \({7 \choose 3}\) ways (for each of the \({4 \choose 2}\) choices of which 2 kids to over-feed).</p>
<p id="llS">But now we have removed too much. We must add back in all the ways to give too many cookies to three kids. This uses 9 cookies, leaving only 1 to distribute to the 4 kids using stars and bars, which can be done in \({4 \choose 3}\) ways. We must consider this outcome for every possible choice of which three kids we over-feed, and there are \({4 \choose 3}\) ways of selecting that set of 3 kids.</p>
<p id="Rtb">Next we would subtract all the ways to give four kids too many cookies, but in this case, that number is 0.</p>
<p id="xAk">All together we get that the number of ways to distribute 10 cookies to 4 kids without giving any kid more than 2 cookies is:</p>
<div class="displaymath">
\begin{equation*}
{13 \choose 3} - \left[{4 \choose 1}{10 \choose 3} - {4 \choose 2}{7 \choose 3} + {4\choose 3}{4\choose 3}\right]
\end{equation*}
</div>
<p data-braille="continuation">which is</p>
<div class="displaymath">
\begin{equation*}
286 - [480 - 210 + 16] = 0\text{.}
\end{equation*}
</div>
<p id="dHt">This makes sense: there is NO way to distribute 10 cookies to 4 kids and make sure that nobody gets more than 2. It is slightly surprising that</p>
<div class="displaymath">
\begin{equation*}
{13 \choose 3} = \left[{4 \choose 1}{10 \choose 3} - {4 \choose 2}{7 \choose 3} + {4\choose 3}{4\choose 3}\right]\text{,}
\end{equation*}
</div>
<p data-braille="continuation">but since PIE works, this equality must hold.</p>
</div></div>
</div></article><p id="WMO">Just so you don't think that these problems always have easier solutions, consider the following example.</p>
<article class="example example-like" id="VOz"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.3</span><span class="period">.</span>
</h6>
<p id="cCa">Earlier (<a class="xref" data-knowl="./knowl/example-stars-bars-int-sol.html" title="Example 3.6.3">Example 3.6.3</a>) we counted the number of solutions to the equation</p>
<div class="displaymath">
\begin{equation*}
x_1 + x_2 + x_3 + x_4 + x_5 = 13\text{,}
\end{equation*}
</div>
<p data-braille="continuation">where \(x_i \ge 0\) for each \(x_i\text{.}\)</p>
<p id="IJj">How many of those solutions have \(0 \le x_i \le 3\) for each \(x_i\text{?}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-ays" id="ays"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-ays"><div class="solution solution-like">
<p id="JOC">We must subtract off the number of solutions in which one or more of the variables has a value greater than 3. We will need to use PIE because counting the number of solutions for which each of the five variables separately are greater than 3 counts solutions multiple times. Here is what we get:</p>
<ul id="pVL" class="disc">
<li id="ROA"><p id="hHs">Total solutions: \({17 \choose 4}\text{.}\)</p></li>
<li id="xVJ"><p id="NOB">Solutions where \(x_1 &gt; 3\text{:}\) \({13 \choose 4}\text{.}\) Give \(x_1\) 4 units first, then distribute the remaining 9 units to the 5 variables.</p></li>
<li id="ecS"><p id="tVK">Solutions where \(x_1 &gt; 3\) and \(x_2 &gt; 3\text{:}\) \({9 \choose 4}\text{.}\) After you give 4 units to \(x_1\) and another 4 to \(x_2\text{,}\) you only have 5 units left to distribute.</p></li>
<li id="Kkb"><p id="acT">Solutions where \(x_1 &gt; 3\text{,}\) \(x_2 &gt; 3\) and \(x_3 &gt; 3\text{:}\) \({5 \choose 4}\text{.}\)</p></li>
<li id="qrk"><p id="Gkc">Solutions where \(x_1 &gt; 3\text{,}\) \(x_2 &gt; 3\text{,}\) \(x_3 &gt; 3\text{,}\) and \(x_4 &gt; 3\text{:}\) 0.</p></li>
</ul>
<p id="WcU">We also need to account for the fact that we could choose any of the five variables in the place of \(x_1\) above (so there will be \({5 \choose 1}\) outcomes like this), any pair of variables in the place of \(x_1\) and \(x_2\) (\({5 \choose 2}\) outcomes) and so on. It is because of this that the double counting occurs, so we need to use PIE. All together we have that the number of solutions with \(0 \le x_i \le 3\) is</p>
<div class="displaymath">
\begin{equation*}
{17 \choose 4} - \left[{5\choose 1}{13 \choose 4} - {5 \choose 2}{9 \choose 4} + {5 \choose 3}{5 \choose 4}\right] = 15\text{.}
\end{equation*}
</div>
</div></div>
</div></article></section><section class="subsection" id="nSd"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber"></span> <span class="title">Counting Derangements</span>
</h3>
<a href="sec_advPIE.html#nSd" class="permalink">¶</a><article class="project-like" id="MuN"><h6 class="heading">
<span class="type">Investigate!</span> </h6>
<p id="CTX">For your senior prank, you decide to switch the nameplates on your favorite 5 professors' doors. So that none of them feel left out, you want to make sure that all of the nameplates end up on the wrong door. How many ways can this be accomplished?</p></article><p id="Pip">The advanced use of PIE has applications beyond stars and bars. A <dfn class="terminology">derangement</dfn>  of \(n\) elements \(\{1,2,3,\ldots,
n\}\) is a permutation in which no element is fixed. For example, there are \(6\) permutations of the three elements \(\{1,2,3\}\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
123 ~~ 132 ~~ 213 ~~ 231 ~~ 312 ~~ 321\text{.}
\end{equation*}
</div>
<p data-braille="continuation">but most of these have one or more elements fixed: \(123\) has all three elements fixed since all three elements are in their original positions, \(132\) has the first element fixed (1 is in its original first position), and so on. In fact, the only derangements of three elements are</p>
<div class="displaymath">
\begin{equation*}
231 \text{ and } 312\text{.}
\end{equation*}
</div>
<p id="vpy">If we go up to 4 elements, there are 24 permutations (because we have 4 choices for the first element, 3 choices for the second, 2 choices for the third leaving only 1 choice for the last). How many of these are derangements? If you list out all 24 permutations and eliminate those which are not derangements, you will be left with just 9 derangements. Let's see how we can get that number using PIE.</p>
<article class="example example-like" id="Agv"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.4</span><span class="period">.</span>
</h6>
<p id="oQs">How many derangements are there of 4 elements?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-GFB" id="GFB"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-GFB"><div class="solution solution-like">
<p id="Ckd">We count all permutations, and subtract those which are not derangements. There are \(4! = 24\) permutations of 4 elements. Now for a permutation to <em class="emphasis">not</em> be a derangement, at least one of the 4 elements must be fixed. There are \({4 \choose 1}\) choices for which single element we fix. Once fixed, we need to find a permutation of the other three elements. There are \(3!\) permutations on 3 elements.</p>
<p id="irm">But now we have counted too many non-derangements, so we must subtract those permutations which fix two elements. There are \({4 \choose 2}\) choices for which two elements we fix, and then for each pair, \(2!\) permutations of the remaining elements. But this subtracts too many, so add back in permutations which fix 3 elements, all \({4 \choose 3}1!\) of them. Finally subtract the \({4 \choose 4}0!\) permutations (recall \(0! = 1\)) which fix all four elements. All together we get that the number of derangements of 4 elements is:</p>
<div class="displaymath">
\begin{equation*}
4! - \left[{4 \choose 1}3! - {4 \choose 2}2! + {4 \choose 3} 1! - {4 \choose 4}0!\right] = 24 - 15 = 9\text{.}
\end{equation*}
</div>
</div></div>
</div></article><p id="bwH">Of course we can use a similar formula to count the derangements of any number of elements. However, the more elements we have, the longer the formula gets. Here is another example:</p>
<article class="example example-like" id="gnE"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.5</span><span class="period">.</span>
</h6>
<p id="UXB">Five gentlemen attend a party, leaving their hats at the door. At the end of the party, they hastily grab hats on their way out. How many different ways could this happen so that none of the gentlemen leave with his own hat?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-mMK" id="mMK"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-mMK"><div class="solution solution-like">
<p id="Oyv">We are counting derangements on 5 elements. There are \(5!\) ways for the gentlemen to grab hats in any order—but many of these permutations will result in someone getting their own hat. So we subtract all the ways in which one or more of the men get their own hat. In other words, we subtract the non-derangements. Doing so requires PIE. Thus the answer is:</p>
<div class="displaymath">
\begin{equation*}
5! - \left[{5 \choose 1}4! - {5 \choose 2}3! + {5 \choose 3}2! - {5 \choose 4}1! + {5 \choose 5}0!\right]\text{.}
\end{equation*}
</div>
</div></div>
</div></article></section><section class="subsection" id="TZm"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber"></span> <span class="title">Counting Functions</span>
</h3>
<a href="sec_advPIE.html#TZm" class="permalink">¶</a><article class="project-like" id="dsY"><h6 class="heading">
<span class="type">Investigate!</span> </h6>
<ol id="jbg" class="decimal">
<li id="bim"><p id="mrl">Consider all functions \(f: \{1,2,3,4,5\} \to \{1,2,3,4,5\}\text{.}\) How many functions are there all together? How many of those are injective? Remember, a function is an injection if every input goes to a different output.</p></li>
<li id="Hpv">
<p id="Syu">Consider all functions \(f: \{1,2,3,4,5\} \to \{1,2,3,4,5\}\text{.}\) How many of the <em class="emphasis">injections</em> have the property that \(f(x) \ne x\) for any \(x \in \{1,2,3,4,5\}\text{?}\) </p>
<p id="yFD">Your friend claims that the answer is:</p>
<div class="displaymath">
\begin{equation*}
5! - \left[ {5\choose 1}4! - {5 \choose 2}3! + {5\choose 3}2! - {5 \choose 4}1! + {5\choose 5}0! \right]\text{.}
\end{equation*}
</div>
<p id="eMM">Explain why this is correct.</p>
</li>
<li id="nwE"><p id="KTV">Recall that a <em class="emphasis">surjection</em>  is a function for which every element of the codomain is in the range. How many of the functions \(f: \{1,2,3,4,5\} \to \{1,2,3,4,5\}\) are surjective? Use PIE!</p></li>
</ol></article><p id="HDQ">We have seen throughout this chapter that many counting questions can be rephrased as questions about counting functions with certain properties. This is reasonable since many counting questions can be thought of as counting the number of ways to assign elements from one set to elements of another.</p>
<article class="example example-like" id="sBW"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.6</span><span class="period">.</span>
</h6>
<p id="BeK">You decide to give away your video game collection so as to better spend your time studying advanced mathematics. How many ways can you do this, provided:</p>
<ol class="decimal">
<li id="TDN">You want to distribute your 3 different PS4 games among 5 friends, so that no friend gets more than one game?</li>
<li id="zKW">You want to distribute your 8 different 3DS games among 5 friends?</li>
<li id="fSf">You want to distribute your 8 different SNES games among 5 friends, so that each friend gets at least one game?</li>
</ol>
<p data-braille="continuation">In each case, model the counting question as a function counting question.</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-STT" id="STT"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-STT"><div class="solution solution-like"><ol id="uFE" class="decimal">
<li id="LZo">
<p id="rbe">We must use the three games (call them 1, 2, 3) as the domain and the 5 friends (a,b,c,d,e) as the codomain (otherwise the function would not be defined for the whole domain when a friend didn't get any game). So how many functions are there with domain \(\{1,2,3\}\) and codomain \(\{a,b,c,d,e\}\text{?}\) The answer to this is \(5^3=125\text{,}\) since we can assign any of 5 elements to be the image of 1, any of 5 elements to be the image of 2 and any of 5 elements to be the image of 3.</p>
<p id="Xin">But this is not the correct answer to our counting problem, because one of these functions is \(f= \twoline{1\amp 2\amp 3}{a\amp a\amp a}\text{;}\) one friend can get more than one game. What we really need to do is count <em class="emphasis">injective</em> functions. This gives \(P(5,3) = 60\) functions, which is the answer to our counting question.</p>
</li>
<li id="sgx"><p id="Dpw">Again, we need to use the 8 games as the domain and the 5 friends as the codomain. We are counting all functions, so the number of ways to distribute the games is \(5^8\text{.}\)</p></li>
<li id="YnG"><p id="jwF">This question is harder. Use the games as the domain and friends as the codomain (the reverse would not give a function). To ensure that every friend gets at least one game means that every element of the codomain is in the range. In other words, we are looking for <em class="emphasis">surjective</em> functions. How do you count those??</p></li>
</ol></div></div>
</div></article><p id="nKZ">In <a class="xref" data-knowl="./knowl/example-counting-functions-all.html" title="Example 3.2.5: Counting functions">Example 3.2.5</a> we saw how to count all functions (using the multiplicative principle) and in <a class="xref" data-knowl="./knowl/example-counting-functions-injective.html" title="Example 3.4.4: Counting injective functions">Example 3.4.4</a> we learned how to count injective functions (using permutations). Surjective functions are not as easily counted (unless the size of the domain is smaller than the codomain, in which case there are none).</p>
<p id="TSi">The idea is to count the functions which are <em class="emphasis">not</em> surjective, and then subtract that from the total number of functions. This works very well when the codomain has two elements in it:</p>
<article class="example example-like" id="YJf"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.7</span><span class="period">.</span>
</h6>
<p id="hlT">How many functions \(f: \{1,2,3,4,5\} \to \{a,b\}\) are surjective?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-zbc" id="zbc"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-zbc"><div class="solution solution-like"><p id="aMN">There are \(2^5\) functions all together, two choices for where to send each of the 5 elements of the domain. Now of these, the functions which are <em class="emphasis">not</em> surjective must exclude one or more elements of the codomain from the range. So first, consider functions for which \(a\) is not in the range. This can only happen one way: everything gets sent to \(b\text{.}\) Alternatively, we could exclude \(b\) from the range. Then everything gets sent to \(a\text{,}\) so there is only one function like this. These are the only ways in which a function could not be surjective (no function excludes both \(a\) and \(b\) from the range) so there are exactly \(2^5 - 2\) surjective functions.</p></div></div>
</div></article><p id="zZr">When there are three elements in the codomain, there are now three choices for a single element to exclude from the range. Additionally, we could pick pairs of two elements to exclude from the range, and we must make sure we don't over count these. It's PIE time!</p>
<article class="example example-like" id="EQo"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.8</span><span class="period">.</span>
</h6>
<p id="Ntc">How many functions \(f: \{1,2,3,4,5\} \to \{a,b,c\}\) are surjective?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-fil" id="fil"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-fil"><div class="solution solution-like">
<p id="GTW">Again start with the total number of functions: \(3^5\) (as each of the five elements of the domain can go to any of three elements of the codomain). Now we count the functions which are <em class="emphasis">not</em> surjective.</p>
<p id="nbf">Start by excluding \(a\) from the range. Then we have two choices (\(b\) or \(c\)) for where to send each of the five elements of the domain. Thus there are \(2^5\) functions which exclude \(a\) from the range. Similarly, there are \(2^5\) functions which exclude \(b\text{,}\) and another \(2^5\) which exclude \(c\text{.}\) Now have we counted all functions which are not surjective? Yes, but in fact, we have counted some multiple times. For example, the function which sends everything to \(c\) was one of the \(2^5\) functions we counted when we excluded \(a\) from the range, and also one of the \(2^5\) functions we counted when we excluded \(b\) from the range. We must subtract out all the functions which specifically exclude two elements from the range. There is 1 function when we exclude \(a\) and \(b\) (everything goes to \(c\)), one function when we exclude \(a\) and \(c\text{,}\) and one function when we exclude \(b\) and \(c\text{.}\)</p>
<p id="Tio">We are using PIE: to count the functions which are not surjective, we added up the functions which exclude \(a\text{,}\) \(b\text{,}\) and \(c\) separately, then subtracted the functions which exclude pairs of elements. We would then add back in the functions which exclude groups of three elements, except that there are no such functions. We find that the number of functions which are <em class="emphasis">not</em> surjective is</p>
<div class="displaymath">
\begin{equation*}
2^5 + 2^5 + 2^5 - 1 - 1 - 1 + 0\text{.}
\end{equation*}
</div>
<p id="zpx">Perhaps a more descriptive way to write this is</p>
<div class="displaymath">
\begin{equation*}
{3 \choose 1}2^5 - {3 \choose 2}1^5 + {3 \choose 3}0^5\text{.}
\end{equation*}
</div>
<p data-braille="continuation">since each of the \(2^5\)'s was the result of choosing 1 of the 3 elements of the codomain to exclude from the range, each of the three \(1^5\)'s was the result of choosing 2 of the 3 elements of the codomain to exclude. Writing \(1^5\) instead of 1 makes sense too: we have 1 choice of where to send each of the 5 elements of the domain.</p>
<p id="fwG">Now we can finally count the number of surjective functions:</p>
<div class="displaymath">
\begin{equation*}
3^5 - \left[{3 \choose 1}2^5 - {3 \choose 2}1^5\right] = 150\text{.}
\end{equation*}
</div>
</div></div>
</div></article><p id="ggA">You might worry that to count surjective functions when the codomain is larger than 3 elements would be too tedious. We need to use PIE but with more than 3 sets the formula for PIE is very long. However, we have lucked out. As we saw in the example above, the number of functions which exclude a single element from the range is the same no matter which single element is excluded. Similarly, the number of functions which exclude a pair of elements will be the same for every pair. With larger codomains, we will see the same behavior with groups of 3, 4, and more elements excluded. So instead of adding/subtracting each of these, we can simply add or subtract all of them at once, if you know how many there are. This works just like it did in for the other types of counting questions in this section, only now the size of the various combinations of sets is a number raised to a power, as opposed to a binomial coefficient or factorial. Here's what happens with \(4\) and \(5\) elements in the codomain.</p>
<article class="example example-like" id="kXx"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.9</span><span class="period">.</span>
</h6>
<ol id="tAl" class="decimal">
<li id="EuP"><p id="PDO">How many functions \(f: \{1,2,3,4,5\} \to \{a,b,c,d\}\) are surjective?</p></li>
<li id="kBY"><p id="vKX">How many functions \(f: \{1,2,3,4,5\} \to \{a,b,c,d,e\}\) are surjective?</p></li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-Lpu" id="Lpu"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-Lpu"><div class="solution solution-like"><ol id="LDP" class="decimal">
<li id="QJh">
<p id="bSg">There are \(4^5\) functions all together; we will subtract the functions which are not surjective. We could exclude any one of the four elements of the codomain, and doing so will leave us with \(3^5\) functions for each excluded element. This counts too many so we subtract the functions which exclude two of the four elements of the codomain, each pair giving \(2^5\) functions. But this excludes too many, so we add back in the functions which exclude three of the four elements of the codomain, each triple giving \(1^5\) function. There are \({4 \choose 1}\) groups of functions excluding a single element, \({4 \choose 2}\) groups of functions excluding a pair of elements, and \({4 \choose 3}\) groups of functions excluding a triple of elements. This means that the number of functions which are <em class="emphasis">not</em> surjective is:</p>
<div class="displaymath">
\begin{equation*}
{4 \choose 1}3^5 - {4 \choose 2}2^5 + {4 \choose 3}1^5\text{.}
\end{equation*}
</div>
<p data-braille="continuation">We can now say that the number of functions which are surjective is:</p>
<div class="displaymath">
\begin{equation*}
4^5 - \left[{4 \choose 1}3^5 - {4 \choose 2}2^5 + {4 \choose 3}1^5\right]\text{.}
\end{equation*}
</div>
</li>
<li id="wQq">
<p id="HZp">The number of surjective functions is:</p>
<div class="displaymath">
\begin{equation*}
5^5 - \left[{5 \choose 1}4^5 - {5 \choose 2}3^5 + {5 \choose 3}2^5 - {5 \choose 4}1^5\right]\text{.}
\end{equation*}
</div>
<p data-braille="continuation">We took the total number of functions \(5^5\) and subtracted all that were not surjective. There were \({5 \choose 1}\) ways to select a single element from the codomain to exclude from the range, and for each there were \(4^5\) functions. But this double counts, so we use PIE and subtract functions excluding two elements from the range: there are \({5 \choose 2}\) choices for the two elements to exclude, and for each pair, \(3^5\) functions. This takes out too many functions, so we add back in functions which exclude 3 elements from the range: \({5 \choose 3}\) choices for which three to exclude, and then \(2^5\) functions for each choice of elements. Finally we take back out the 1 function which excludes 4 elements for each of the \({5 \choose 4}\) choices of 4 elements.</p>
<p id="ogy">If you happen to calculate this number precisely, you will get 120 surjections. That happens to also be the value of \(5!\text{.}\) This might seem like an amazing coincidence until you realize that every surjective function \(f:X \to Y\) with \(\card{X} = \card{Y}\) finite must necessarily be a bijection. The number of bijections is always \(\card{X}!\) in this case. What we have here is a <em class="emphasis">combinatorial proof</em> of the following identity:</p>
<div class="displaymath">
\begin{equation*}
n^n - \left[{n\choose 1}(n-1)^n - {n \choose 2}(n-2)^n + \cdots + {n \choose n-1}1^n \right] = n!\text{.}
\end{equation*}
</div>
</li>
</ol></div></div>
</div></article><p id="MnJ"> We have seen that counting surjective functions is another nice example of the advanced use of the Principle of Inclusion/Exclusion. Also, counting injective functions turns out to be equivalent to permutations, and counting all functions has a solution akin to those counting problems where order matters but repeats are allowed (like counting the number of words you can make from a given set of letters).</p>
<p id="suS">These are not just a few more examples of the techniques we have developed in this chapter. Quite the opposite: everything we have learned in this chapter are examples of <em class="emphasis">counting functions</em>!</p>
<article class="example example-like" id="ReG"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.10</span><span class="period">.</span>
</h6>
<p id="ZHu">How many 5-letter words can you make using the eight letters \(a\) through \(h\text{?}\) How many contain no repeated letters?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-rwD" id="rwD"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-rwD"><div class="solution solution-like">
<p id="rKY">By now it should be no surprise that there are \(8^5\) words, and \(P(8,5)\) words without repeated letters. The new piece here is that we are actually counting functions. For the first problem, we are counting all functions from \(\{1,2,\ldots, 5\}\) to \(\{a,b,\ldots, h\}\text{.}\) The numbers in the domain represent the <em class="emphasis">position</em> of the letter in the word, the codomain represents the letter that could be assigned to that position. If we ask for no repeated letters, we are asking for injective functions.</p>
<p id="XSh">If \(A\) and \(B\) are <em class="emphasis">any</em> sets with \(|A| = 5\) and \(|B| = 8\text{,}\) then the number of functions \(f: A \to B\) is \(8^5\) and the number of injections is \(P(8,5)\text{.}\) So if you can represent your counting problem as a function counting problem, most of the work is done.</p>
</div></div>
</div></article><article class="example example-like" id="xlP"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.7.11</span><span class="period">.</span>
</h6>
<p id="FOD">How many subsets are there of \(\{1,2,\ldots, 9\}\text{?}\) How many 9-bit strings are there (of any weight)?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-XDM" id="XDM"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-XDM"><div class="solution solution-like">
<p id="DZq">We saw in <a href="sec_counting-binom.html" class="internal" title="Section 3.3: Binomial Coefficients">Section 3.3</a> that the answer to both these questions is \(2^9\text{,}\) as we can say yes or no (or 0 or 1) to each of the 9 elements in the set (positions in the bit-string). But \(2^9\) also looks like the answer you get from counting functions. In fact, if you count all functions \(f: A \to B\) with \(|A| = 9\) and \(|B| = 2\text{,}\) this is exactly what you get.</p>
<p id="kgz">This makes sense! Let \(A = \{1,2,\ldots, 9\}\) and \(B = \{y, n\}\text{.}\) We are assigning each element of the set either a yes or a no. Or in the language of bit-strings, we would take the 9 positions in the bit string as our domain and the set \(\{0,1\}\) as the codomain.</p>
</div></div>
</div></article><p id="YCb"> So far we have not used a function as a model for binomial coefficients (combinations). Think for a moment about the relationship between combinations and permutations, say specifically \({9 \choose 3}\) and \(P(9,3)\text{.}\) We <em class="emphasis">do</em> have a function model for \(P(9,3)\text{.}\) This is the number of <em class="emphasis">injective</em> functions from a set of size 3 (say \(\{1,2,3\}\) to a set of size 9 (say \(\{1,2,\ldots, 9\}\)) since there are 9 choices for where to send the first element of the domain, then only 8 choices for the second, and 7 choices for the third. For example, the function might look like this:</p>
<div class="displaymath">
\begin{equation*}
f(1) = 5 \qquad f(2) = 8 \qquad f(3) = 4\text{.}
\end{equation*}
</div>
<p id="EJk">This is a different function from:</p>
<div class="displaymath">
\begin{equation*}
f(1) = 4 \qquad f(2) = 5 \qquad f(3) = 8\text{.}
\end{equation*}
</div>
<p id="kQt">Now \(P(9,3)\) counts these as different outcomes correctly, but \({9\choose 3}\) will count these (among others) as just one outcome. In fact, in terms of functions \({9 \choose 3}\) just counts the number of different ranges possible of injective functions. This should not be a surprise since binomial coefficients counts subsets, and the range is a possible subset of the codomain.<a data-knowl="" class="id-ref fn-knowl" data-refid="hk-fn-19" id="fn-19"><sup> 3 </sup></a></p>
<div class="hidden-content tex2jax_ignore" id="hk-fn-19"><div class="fn">A more mathematically sophisticated interpretation of combinations is that we are defining two injective functions to be <em class="emphasis">equivalent</em> if they have the same range, and then counting the number of equivalence classes under this notion of equivalence.</div></div>
<p id="QXC">While it is possible to interpret combinations as functions, perhaps the better advice is to instead use combinations (or stars and bars) when functions are not quite the right way to interpret the counting question.</p></section><section class="exercises" id="nUq"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber"></span> <span class="title">Exercises</span>
</h3>
<a href="sec_advPIE.html#nUq" class="permalink">¶</a><article class="exercise exercise-like" id="COT"><h6 class="heading"><span class="codenumber">1<span class="period">.</span></span></h6>
<p id="p-3666">The dollar menu at your favorite tax-free fast food restaurant has 7 items. You have $10 to spend. How many different meals can you buy if you spend all your money and:</p>
<ol class="lower-alpha">
<li id="li-1567"><p id="p-3667">Purchase at least one of each item.</p></li>
<li id="li-1568"><p id="p-3669">Possibly skip some items.</p></li>
<li id="li-1569"><p id="p-3671">Don’t get more than 2 of any particular item.</p></li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-176" id="answer-176"><span class="type">Answer</span><span class="space"> </span><span class="codenumber">1</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-176"><div class="answer solution-like"><p id="p-3673">\(\mathop{\rm C}\nolimits\!\left(9,6\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-answer-177" id="answer-177"><span class="type">Answer</span><span class="space"> </span><span class="codenumber">2</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-177"><div class="answer solution-like"><p id="p-3674">\(\mathop{\rm C}\nolimits\!\left(16,6\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-answer-178" id="answer-178"><span class="type">Answer</span><span class="space"> </span><span class="codenumber">3</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-178"><div class="answer solution-like"><p id="p-3675">\(\mathop{\rm C}\nolimits\!\left(16,6\right)-\left(\mathop{\rm C}\nolimits\!\left(7,1\right)\mathop{\rm C}\nolimits\!\left(13,6\right)-\mathop{\rm C}\nolimits\!\left(7,2\right)\mathop{\rm C}\nolimits\!\left(10,6\right)+\mathop{\rm C}\nolimits\!\left(7,3\right)\mathop{\rm C}\nolimits\!\left(7,6\right)\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-288" id="solution-288"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-288"><div class="solution solution-like"><ol id="p-3676" class="lower-alpha">
<li id="li-1570"><p id="p-3677">\({9 \choose 3}\) meals. First spend $7 to buy one of each item, then use 3 stars to select items between 6 bars.</p></li>
<li id="li-1571"><p id="p-3678">\({16 \choose 6}\) meals. Here you have 10 stars and 6 bars (separating the 7 items).</p></li>
<li id="li-1572"><p id="p-3679">\({16 \choose 6} - \left[{7 \choose 1}{13 \choose 6} - {7 \choose 2}{10 \choose 6} + {7 \choose 3}{7 \choose 6}\right]\) meals. Use PIE to subtract all the meals in which you get 3 or more of a particular item.</p></li>
</ol></div></div>
</div></article><article class="exercise exercise-like" id="iWc"><h6 class="heading"><span class="codenumber">2<span class="period">.</span></span></h6>
<p id="EiH">After a late night of math studying, you and your friends decide to go to your favorite tax-free fast food Mexican restaurant, <em class="emphasis">Burrito Chime</em>. You decide to order off of the dollar menu, which has 7 items. Your group has $16 to spend (and will spend all of it).</p>
<ol class="lower-alpha">
<li id="PNf"><p id="lvj">How many different orders are possible? Explain. (The <em class="emphasis">order</em> in which the order is placed does not matter - just which and how many of each item that is ordered.)</p></li>
<li id="vUo"><p id="RCs">How many different orders are possible if you want to get at least one of each item? Explain.</p></li>
<li id="cbx"><p id="xJB">How many different orders are possible if you don't get more than 4 of any one item? Explain.</p></li>
</ol></article><article class="exercise exercise-like" id="Pdl"><h6 class="heading"><span class="codenumber">3<span class="period">.</span></span></h6>
<p id="p-3687">After another gym class you are tasked with putting the 14 identical dodgeballs away into 5 bins. This time, no bin can hold more than 6 balls. How many ways can you clean up?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-179" id="answer-179"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-179"><div class="answer solution-like"><p id="p-3689">\(\mathop{\rm C}\nolimits\!\left(18,4\right)-\left(\mathop{\rm C}\nolimits\!\left(5,1\right)\mathop{\rm C}\nolimits\!\left(11,4\right)-\mathop{\rm C}\nolimits\!\left(5,2\right)\mathop{\rm C}\nolimits\!\left(4,4\right)\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-290" id="solution-290"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-290"><div class="solution solution-like"><p id="p-3690">\({18 \choose 4} - \left[ {5 \choose 1}{11 \choose 4} - {5 \choose 2}{4 \choose 4}\right]\text{.}\)</p></div></div>
</div></article><article class="exercise exercise-like" id="vku"><h6 class="heading"><span class="codenumber">4<span class="period">.</span></span></h6>
<p id="p-3695">Consider the equation \(x_1 + x_2 + x_3 + x_4 = 15\text{.}\) How many solutions are there with \(2 \le x_i \le 5\) for all \(i \in \{1,2,3,4\}\text{?}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-hint-98" id="hint-98"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-98"><div class="hint solution-like"><p id="p-3697">Instead, count the solutions to \(y_1 + y_2 + y_3 + y_4 = 7\) with \(0 \le y_i \le 3\text{.}\)  Why is this equivalent?</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-answer-180" id="answer-180"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-180"><div class="answer solution-like"><p id="p-3698">\(\mathop{\rm C}\nolimits\!\left(10,7\right)-\mathop{\rm C}\nolimits\!\left(4,1\right)\mathop{\rm C}\nolimits\!\left(6,3\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-292" id="solution-292"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-292"><div class="solution solution-like"><p id="p-3699">There are \({10 \choose 7} - {4\choose 1} {6 \choose 3}\) solutions.</p></div></div>
</div></article><article class="exercise exercise-like" id="brD"><h6 class="heading"><span class="codenumber">5<span class="period">.</span></span></h6>
<p id="p-3705">Suppose you planned on giving 7 gold stars to some of the 13 star students in your class. Each student can receive at most one star. How many ways can you do this?</p>
<p id="p-3707">Use PIE. Then, find the numeric answer in Pascal’s triangle and explain why that makes sense.</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-181" id="answer-181"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-181"><div class="answer solution-like"><p id="p-3708">\(\mathop{\rm C}\nolimits\!\left(13,7\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-294" id="solution-294"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-294"><div class="solution solution-like">
<p id="p-3709">Without any restriction, there would be \({19\choose 7}\) ways to distribute the stars. Now we must use PIE to eliminate all distributions in which one or more student gets more than one star:</p>
<div class="displaymath" id="p-3710">
\begin{equation*}
{19 \choose 7} - \left[{13 \choose 1}{17 \choose 5} - {13\choose 2}{15 \choose 3} + {13\choose 3}{13 \choose 1}\right] = 1716
\text{.}
\end{equation*}
</div>
<p id="p-3711">Interestingly enough, this number is also the value of \({13 \choose 7}\text{,}\) which makes sense: if each student can have at most one star, we must just pick the 7 out of 13 students to receive them.</p>
</div></div>
</div></article><article class="exercise exercise-like" id="HyM"><h6 class="heading"><span class="codenumber">6<span class="period">.</span></span></h6>
<p id="Bob">Based on the previous question, give a combinatorial proof for the identity:</p>
<div class="displaymath">
\begin{equation*}
{n \choose k} = {n+k-1 \choose k} - \sum_{j=1}^n (-1)^{j+1}{n \choose j}{n+k-(2j+1) \choose k - 2j}\text{.}
\end{equation*}
</div></article><article class="exercise exercise-like" id="nFV"><h6 class="heading"><span class="codenumber">7<span class="period">.</span></span></h6>
<p id="hvk">Illustrate how the counting of derangements works by writing all permutations of \(\{1,2,3,4\}\) and the crossing out those which are not derangements. Keep track of the permutations you cross out more than once, using PIE.</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-pvi" id="pvi"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-pvi"><div class="solution solution-like"><p id="aWe">The 9 derangements are: 2143, 2341, 2413, 3142, 3412, 3421, 4123, 4312, 4321.</p></div></div>
</div></article><article class="exercise exercise-like" id="TNe"><h6 class="heading"><span class="codenumber">8<span class="period">.</span></span></h6>
<p id="p-3718">How many permutations of \(\{1,2,3,4,5\}\) leave exactly 1 element fixed?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-182" id="answer-182"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-182"><div class="answer solution-like"><p id="p-3720">\(\mathop{\rm C}\nolimits\!\left(5,1\right)\!\left(4!-\left(\mathop{\rm C}\nolimits\!\left(4,1\right)\!\left(3!\right)-\mathop{\rm C}\nolimits\!\left(4,2\right)\!\left(2!\right)+\mathop{\rm C}\nolimits\!\left(4,3\right)\!\left(1!\right)-\mathop{\rm C}\nolimits\!\left(4,4\right)\!\left(0!\right)\right)\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-297" id="solution-297"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-297"><div class="solution solution-like"><p id="p-3721">First pick one of the five elements to be fixed. For each such choice, derange the remaining four, using the standard advanced PIE formula. We get \({5 \choose 1}\left( 4! - \left[{4 \choose 1}3! - {4 \choose 2}2! + {4 \choose 3} 1! - {4 \choose 4} 0!\right] \right)\) permutations.</p></div></div>
</div></article><article class="exercise exercise-like" id="zUn"><h6 class="heading"><span class="codenumber">9<span class="period">.</span></span></h6>
<p id="p-3725">Ten ladies of a certain age drop off their red hats at the hat check of a museum. As they are leaving, the hat check attendant gives the hats back randomly. In how many ways can exactly six of the ladies receive their own hat (and the other four not)? Explain.</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-183" id="answer-183"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-183"><div class="answer solution-like"><p id="p-3727">\(\mathop{\rm C}\nolimits\!\left(10,6\right)\!\left(4!-\left(\mathop{\rm C}\nolimits\!\left(4,1\right)\!\left(3!\right)-\mathop{\rm C}\nolimits\!\left(4,2\right)\!\left(2!\right)+\mathop{\rm C}\nolimits\!\left(4,3\right)\!\left(1!\right)-\mathop{\rm C}\nolimits\!\left(4,4\right)\!\left(0!\right)\right)\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-299" id="solution-299"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-299"><div class="solution solution-like"><p id="p-3728">\({10 \choose 6}\left(4! - \left[{4 \choose 1} 3! - {4 \choose 2}2! + {4 \choose 3}1! - {4 \choose 4}0!\right]\right)\) ways. We choose 6 of the 10 ladies to get their own hat, and the multiply by the number of ways the remaining hats can be deranged.</p></div></div>
</div></article><article class="exercise exercise-like" id="gbw"><h6 class="heading"><span class="codenumber">10<span class="period">.</span></span></h6>
<p id="mfd">The Grinch sneaks into a room with 6 Christmas presents to 6 different people. He proceeds to switch the name-labels on the presents. How many ways could he do this if:</p>
<ol class="lower-alpha">
<li id="IiG"><p id="dQK">No present is allowed to end up with its original label? Explain what each term in your answer represents.</p></li>
<li id="opP"><p id="JXT">Exactly 2 presents keep their original labels? Explain.</p></li>
<li id="UwY"><p id="qfc">Exactly 5 presents keep their original labels? Explain.</p></li>
</ol></article><article class="exercise exercise-like" id="MiF"><h6 class="heading"><span class="codenumber">11<span class="period">.</span></span></h6>
<p id="p-3736">Consider functions \(f: \{1,2,3,4\} \to \{a,b,c,d,e,f\}\text{.}\) How many functions have the property that \(f(1) \ne a\) or \(f(2) \ne b\text{,}\) or both?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-184" id="answer-184"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-184"><div class="answer solution-like"><p id="p-3738">\(5\cdot 6^{3}+5\cdot 6^{3}-5^{2}\cdot 6^{2}\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-301" id="solution-301"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-301"><div class="solution solution-like">
<p id="p-3739">There are \(5 \cdot 6^3\) functions for which \(f(1) \ne a\) and another \(5 \cdot 6^3\) functions for which \(f(2) \ne b\text{.}\) There are \(5^2 \cdot 6^2\) functions for which both \(f(1) \ne a\) and \(f(2) \ne b\text{.}\) So the total number of functions for which \(f(1) \ne a\) or \(f(2) \ne b\) or both is</p>
<div class="displaymath" id="p-3740">
\begin{equation*}
5 \cdot 6^3 + 5 \cdot 6^3 - 5^2 \cdot 6^2 = 1260
\text{.}
\end{equation*}
</div>
</div></div>
</div></article><article class="exercise exercise-like" id="spO"><h6 class="heading"><span class="codenumber">12<span class="period">.</span></span></h6>
<p id="p-3744">Consider sets \(A\) and \(B\) with \(|A| = 10\) and \(|B| = 5\text{.}\) How many functions \(f: A \to B\) are surjective?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-answer-185" id="answer-185"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-185"><div class="answer solution-like"><p id="p-3746">\(5^{10}-\left(\mathop{\rm C}\nolimits\!\left(5,1\right)\cdot 4^{10}-\mathop{\rm C}\nolimits\!\left(5,2\right)\cdot 3^{10}+\mathop{\rm C}\nolimits\!\left(5,3\right)\cdot 2^{10}-\mathop{\rm C}\nolimits\!\left(5,4\right)\cdot 1^{10}\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-303" id="solution-303"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-303"><div class="solution solution-like"><p id="p-3747">\(5^{10} - \left[{5 \choose 1}4^{10} - {5 \choose 2}3^{10} + {5 \choose 3}2^{10} - {5 \choose 4}1^{10}\right]\) functions. The \(5^{10}\) is all the functions from \(A\) to \(B\text{.}\) We subtract those that aren’t surjective. Pick one of the five elements in \(B\) to not have in the range (in \({5 \choose 1}\) ways) and count all those functions (\(4^{10}\)). But this overcounts the functions where two elements from \(B\) are excluded from the range, so subtract those. And so on, using PIE.</p></div></div>
</div></article><article class="exercise exercise-like" id="YwX"><h6 class="heading"><span class="codenumber">13<span class="period">.</span></span></h6>
<p id="p-3752">Let \(A = \{1,2,3,4,5\}\text{.}\) How many injective functions \(f:A \to A\) have the property that for each \(x \in A\text{,}\) \(f(x) \ne x\text{?}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-hint-100" id="hint-100"><span class="type">Hint</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-100"><div class="hint solution-like"><p id="p-3754">This is a sneaky way to ask for the number of derangements on 5 elements.  Do you see why?</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-answer-186" id="answer-186"><span class="type">Answer</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-186"><div class="answer solution-like"><p id="p-3755">\(5!-\left(\mathop{\rm C}\nolimits\!\left(5,1\right)\!\left(4!\right)-\mathop{\rm C}\nolimits\!\left(5,2\right)\!\left(3!\right)+\mathop{\rm C}\nolimits\!\left(5,3\right)\!\left(2!\right)-\mathop{\rm C}\nolimits\!\left(5,4\right)\!\left(1!\right)+\mathop{\rm C}\nolimits\!\left(5,5\right)\!\left(0!\right)\right)\)</p></div></div>
<a data-knowl="" class="id-ref original" data-refid="hk-solution-305" id="solution-305"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-305"><div class="solution solution-like"><p id="p-3756">\(5! - \left[{5 \choose 1}4! - {5 \choose 2}3! + {5 \choose 3}2! - {5 \choose 4}1! + {5 \choose 5}0!\right]\) functions.</p></div></div>
</div></article><article class="exercise exercise-like" id="EEg"><h6 class="heading"><span class="codenumber">14<span class="period">.</span></span></h6>
<p id="Ddo">Let \(d_n\) be the number of derangements of \(n\) objects. For example, using the techniques of this section, we find</p>
<div class="displaymath">
\begin{equation*}
d_3 = 3!-\left({3 \choose 1}2! - {3 \choose 2}1! + {3 \choose 3}0! \right)\text{.}
\end{equation*}
</div>
<p data-braille="continuation">We can use the formula for \({n \choose k}\) to write this all in terms of factorials. After simplifying, for \(d_3\) we would get</p>
<div class="displaymath">
\begin{equation*}
d_3 = 3!\left(1 - \frac{1}{1} + \frac{1}{2} - \frac{1}{6} \right)\text{.}
\end{equation*}
</div>
<p data-braille="continuation">Generalize this to find a nicer formula for \(d_n\text{.}\) Bonus: For large \(n\text{,}\) approximately what fraction of all permutations are derangements? Use your knowledge of Taylor series from calculus.</p></article></section></section></div></main>
</div>
</body>
</html>
